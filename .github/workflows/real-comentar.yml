name: Real Comentar web.config

on:

  workflow_dispatch: #

jobs:
  modificar-webconfig:
    runs-on: ubuntu-latest

    steps:
    - name: Comentar bloque de código en web.config
      uses: actions/github-script@v6
      with:
        script: |
          // Obtener el contenido del archivo web.config
          const fs = require('fs');
          const webConfigPath = 'web.config';
          const webConfigContent = fs.readFileSync(webConfigPath, 'utf8');
    
          // Marcadores de comentario para el bloque específico
          const startCommentMarker = '<sessionState mode="Custom" customProvider="MySessionStateStore">';
          const endCommentMarker = '</sessionState>';
    
          // Buscar los marcadores de comentario
          const startCommentIndex = webConfigContent.indexOf(startCommentMarker);
          const endCommentIndex = webConfigContent.indexOf(endCommentMarker, startCommentIndex + startCommentMarker.length);
    
          // Si se encuentran los marcadores, comentar el bloque
          if (startCommentIndex !== -1 && endCommentIndex !== -1) {
            const commentedBlock = webConfigContent.substring(startCommentIndex, endCommentIndex + endCommentMarker.length);
            const updatedWebConfigContent = webConfigContent.replace(commentedBlock, 
                                                                    '');
    
            // Actualizar el archivo web.config con el código comentado
            fs.writeFileSync(webConfigPath, updatedWebConfigContent, 'utf8');
            console.log('Bloque de código comentado correctamente en web.config');
          } else {
            console.error('No se encontraron los marcadores de comentario en web.config');
          }
    
    - name: Upload modified web.config
      uses: actions/upload-artifact@v2
      with:
        name: web3.config
        path: web3.config
